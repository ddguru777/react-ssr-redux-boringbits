{"version":3,"sources":["../../../../../src/lib/init-hooks/core-hooks/react/AppInit.js"],"names":["extractStateFromDOM","state","composeEnhancers","compose","isNode","jssStyles","window","document","getElementById","parentNode","removeChild","preloadedState","__PRELOADED_STATE__","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","e","getAppComponents","dependencies","domExtractedState","App","reducers","middleware","history","push","router","Router","enhancer","applyMiddleware","apply","store","generateClassName","sheetsRegistry","SheetsRegistry","getStyleSheets","toString","Container"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA,SAASA,mBAAT,GAA+B;AAC7B,MAAIC,KAAK,GAAG;AACVC,IAAAA,gBAAgB,EAAEC;AADR,GAAZ;;AAGA,MAAI;AACF,QAAI,CAACC,mBAAL,EAAa;AAEX,UAAIC,SAAS,GAAGC,MAAM,CAACC,QAAP,CAAgBC,cAAhB,CAA+B,iBAA/B,CAAhB;;AACA,UAAIH,SAAS,IAAIA,SAAS,CAACI,UAA3B,EAAuC;AACrCJ,QAAAA,SAAS,CAACI,UAAV,CAAqBC,WAArB,CAAiCL,SAAjC;AACD;;AAEDJ,MAAAA,KAAK,CAACU,cAAN,GAAuBL,MAAM,CAACM,mBAAP,IAA8B,EAArD;AACAX,MAAAA,KAAK,CAACC,gBAAN,GAA0BI,MAAM,CAACO,oCAAP,IAA+CV,cAAzE;AACD;AACF,GAXD,CAYA,OAAMW,CAAN,EAAS,CAAE;;AAEX,SAAOb,KAAP;AACD;;AAEc,SAASc,gBAAT,CAA0BC,YAA1B,EAAwC;AAErD;AACA,MAAIC,iBAAiB,GAAGjB,mBAAmB,EAA3C;AACA,MAAIW,cAAc,GAAGM,iBAAiB,CAACN,cAAvC;AACA,MAAIT,gBAAgB,GAAGe,iBAAiB,CAACf,gBAAzC;AAEA,MAAIgB,GAAG,GAAIF,YAAY,CAACE,GAAxB;AACA,MAAIC,QAAQ,GAAGH,YAAY,CAACG,QAA5B;AAEA,MAAIC,UAAU,GAAG,EAAjB;;AACA,MAAIJ,YAAY,CAACK,OAAjB,EAA0B;AACxBD,IAAAA,UAAU,CAACE,IAAX,CAAgB,4CAAiBN,YAAY,CAACK,OAA9B,CAAhB;AACAF,IAAAA,QAAQ,CAACI,MAAT,GAAkB,yCAAcP,YAAY,CAACK,OAA3B,CAAlB;AACD;;AAED,MAAIG,MAAM,GAAGR,YAAY,CAACQ,MAA1B;AACA,MAAIC,QAAQ,GAAIvB,gBAAgB,CAACwB,uBAAgBC,KAAhB,CAAsB,IAAtB,EAA4BP,UAA5B,CAAD,CAAhC;AAEA,MAAIQ,KAAK,GAAG,wBACV,4BAAgBT,QAAhB,CADU,EAEVR,cAFU,EAGVc,QAHU,CAAZ,CAnBqD,CAyBrD;;AACA,MAAII,iBAAiB,GAAG,sCAAxB;AACA,MAAIC,cAAc,GAAG,IAAIC,mBAAJ,EAArB;AAEA;;;;;AAIA,WAASC,cAAT,GAA0B;AACxB,WAAOF,cAAc,CAACG,QAAf,EAAP;AACD;;AAED,WAASC,SAAT,GAAqB;AACnB,WACE,6BAAC,oBAAD;AAAU,MAAA,KAAK,EAAEN;AAAjB,OACE,6BAAC,MAAD,QACE,6BAAC,oBAAD;AAAa,MAAA,QAAQ,EAAEE,cAAvB;AAAuC,MAAA,iBAAiB,EAAED;AAA1D,OACE,6BAAC,GAAD,OADF,CADF,CADF,CADF;AASD;;AACD,SAAO;AACLK,IAAAA,SAAS,EAAEA,SADN;AAELF,IAAAA,cAAc,EAAEA,cAFX;AAGLJ,IAAAA,KAAK,EAAEA;AAHF,GAAP;AAMD","sourcesContent":["import React from 'react';\nimport { SheetsRegistry } from 'react-jss/lib/jss';\nimport JssProvider from 'react-jss/lib/JssProvider';\nimport { createStore, applyMiddleware, combineReducers, compose } from 'redux';\nimport { Provider  } from \"react-redux\";\nimport { createGenerateClassName } from '@material-ui/core/styles';\nimport { routerMiddleware, connectRouter } from 'connected-react-router'\nimport isNode from 'detect-node';\n\nfunction extractStateFromDOM() {\n  var state = {\n    composeEnhancers: compose\n  };\n  try {\n    if (!isNode) {\n      \n      var jssStyles = window.document.getElementById('jss-server-side');\n      if (jssStyles && jssStyles.parentNode) {\n        jssStyles.parentNode.removeChild(jssStyles);\n      }      \n\n      state.preloadedState = window.__PRELOADED_STATE__ || {};\n      state.composeEnhancers =  window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n    }    \n  }\n  catch(e) {}\n  \n  return state;\n}\n \nexport default function getAppComponents(dependencies) {\n\n  // Grab the state from a global variable injected into the server-generated HTML\n  var domExtractedState = extractStateFromDOM();\n  var preloadedState = domExtractedState.preloadedState;\n  var composeEnhancers = domExtractedState.composeEnhancers;\n  \n  var App  = dependencies.App;\n  var reducers = dependencies.reducers;\n\n  var middleware = [];\n  if (dependencies.history) {\n    middleware.push(routerMiddleware(dependencies.history));\n    reducers.router = connectRouter(dependencies.history);\n  }\n\n  var Router = dependencies.Router;\n  var enhancer =  composeEnhancers(applyMiddleware.apply(null, middleware));\n\n  var store = createStore(\n    combineReducers(reducers),\n    preloadedState,\n    enhancer\n  );\n\n  // Create a new class name generator.\n  var generateClassName = createGenerateClassName();\n  var sheetsRegistry = new SheetsRegistry();\n\n  /**\n   * This meant to be called on the server\n   * AFTER MAIN is renedered.\n   */\n  function getStyleSheets() {\n    return sheetsRegistry.toString();\n  }\n\n  function Container() {\n    return (\n      <Provider store={store}>\n        <Router>\n          <JssProvider registry={sheetsRegistry} generateClassName={generateClassName}>\n            <App />\n          </JssProvider>\n        </Router>\n      </Provider>\n    );\n  }\n  return {\n    Container: Container,\n    getStyleSheets: getStyleSheets,\n    store: store\n  }\n\n}"],"file":"AppInit.js"}