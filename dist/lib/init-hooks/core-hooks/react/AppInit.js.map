{"version":3,"sources":["../../../../../src/lib/init-hooks/core-hooks/react/AppInit.js"],"names":["getAppComponents","dependencies","preloadedState","undefined","App","rootReducer","window","__PRELOADED_STATE__","e","middleware","history","push","Router","store","generateClassName","sheetsRegistry","SheetsRegistry","Main","React","Component","componentDidMount","document","jssStyles","getElementById","parentNode","removeChild","render","getStyleSheets","toString","Container"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEe,SAASA,gBAAT,CAA0BC,YAAY,GAAE,EAAxC,EAA4C;AAEzD;AACA,MAAIC,cAAc,GAAGC,SAArB;AACA,QAAMC,GAAG,GAAIH,YAAY,CAACG,GAA1B;AACA,QAAMC,WAAW,GAAGJ,YAAY,CAACI,WAAjC;;AAEA,MAAI;AACF,QAAIC,MAAM,IAAIA,MAAM,CAACC,mBAArB,EAA0C;AACxCL,MAAAA,cAAc,GAAGI,MAAM,CAACC,mBAAxB;AACA,aAAOD,MAAM,CAACC,mBAAd;AACD;AACF,GALD,CAMA,OAAMC,CAAN,EAAS,CAAE;;AAEX,QAAMC,UAAU,GAAG,EAAnB;AACA,MAAIR,YAAY,CAACS,OAAjB,EACED,UAAU,CAACE,IAAX,CAAgB,wCAAiBV,YAAY,CAACS,OAA9B,CAAhB;AAEF,QAAME,MAAM,GAAGX,YAAY,CAACW,MAA5B;AAEA,QAAMC,KAAK,GAAG,wBACZR,WADY,EAEZH,cAFY,EAGZ,4BAAgB,GAAGO,UAAnB,CAHY,CAAd,CArByD,CA2BzD;;AACA,QAAMK,iBAAiB,GAAG,sCAA1B;AACA,QAAMC,cAAc,GAAG,IAAIC,mBAAJ,EAAvB;;AAEA,QAAMC,IAAN,SAAmBC,eAAMC,SAAzB,CAAmC;AACjC;AACAC,IAAAA,iBAAiB,GAAG;AAClB,UAAId,MAAM,IAAIA,MAAM,CAACe,QAArB,EAA+B;AAC7B,cAAMC,SAAS,GAAGhB,MAAM,CAACe,QAAP,CAAgBE,cAAhB,CAA+B,iBAA/B,CAAlB;;AACA,YAAID,SAAS,IAAIA,SAAS,CAACE,UAA3B,EAAuC;AACrCF,UAAAA,SAAS,CAACE,UAAV,CAAqBC,WAArB,CAAiCH,SAAjC;AACD;AACF;AACF;;AAEDI,IAAAA,MAAM,GAAG;AACP,aACE,6BAAC,oBAAD;AAAU,QAAA,KAAK,EAAEb;AAAjB,SACE,6BAAC,MAAD,QACE,6BAAC,oBAAD;AAAa,QAAA,QAAQ,EAAEE,cAAvB;AAAuC,QAAA,iBAAiB,EAAED;AAA1D,SACE,6BAAC,GAAD,OADF,CADF,CADF,CADF;AAUD;;AAtBgC;AA0BnC;;;;;;AAIA,WAASa,cAAT,GAA0B;AACxB,WAAOZ,cAAc,CAACa,QAAf,EAAP;AACD;;AAED,QAAMC,SAAS,GAAGZ,IAAlB;AACA,SAAO;AACLY,IAAAA,SADK;AAELF,IAAAA,cAFK;AAGLd,IAAAA;AAHK,GAAP;AAMD","sourcesContent":["import React from 'react';\nimport { SheetsRegistry } from 'react-jss/lib/jss';\nimport JssProvider from 'react-jss/lib/JssProvider';\nimport { createStore, applyMiddleware } from 'redux';\nimport { Provider  } from \"react-redux\";\nimport { createGenerateClassName } from '@material-ui/core/styles';\nimport { routerMiddleware } from 'react-router-redux';\n\nexport default function getAppComponents(dependencies= {}) {\n\n  // Grab the state from a global variable injected into the server-generated HTML\n  let preloadedState = undefined;\n  const App  = dependencies.App;\n  const rootReducer = dependencies.rootReducer;\n\n  try {\n    if (window && window.__PRELOADED_STATE__) {\n      preloadedState = window.__PRELOADED_STATE__;\n      delete window.__PRELOADED_STATE__;\n    }\n  }\n  catch(e) {}\n\n  const middleware = [];\n  if (dependencies.history)\n    middleware.push(routerMiddleware(dependencies.history));\n\n  const Router = dependencies.Router;\n\n  const store = createStore(\n    rootReducer,\n    preloadedState,\n    applyMiddleware(...middleware)\n  );\n\n  // Create a new class name generator.\n  const generateClassName = createGenerateClassName();\n  const sheetsRegistry = new SheetsRegistry();\n\n  class Main extends React.Component {\n    // Remove the server-side injected CSS.\n    componentDidMount() {\n      if (window && window.document) {\n        const jssStyles = window.document.getElementById('jss-server-side');\n        if (jssStyles && jssStyles.parentNode) {\n          jssStyles.parentNode.removeChild(jssStyles);\n        }\n      }\n    }\n\n    render() {\n      return (\n        <Provider store={store}>\n          <Router>\n            <JssProvider registry={sheetsRegistry} generateClassName={generateClassName}>\n              <App />\n            </JssProvider>\n          </Router>\n        </Provider>\n      )\n\n    }\n  }\n\n\n  /**\n   * This meant to be called on the server\n   * AFTER MAIN is renedered.\n   */\n  function getStyleSheets() {\n    return sheetsRegistry.toString();\n  }\n\n  const Container = Main\n  return {\n    Container,\n    getStyleSheets,\n    store\n  }\n\n}"],"file":"AppInit.js"}