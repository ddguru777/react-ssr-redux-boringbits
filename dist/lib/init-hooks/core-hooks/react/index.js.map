{"version":3,"sources":["../../../../../src/lib/init-hooks/core-hooks/react/index.js"],"names":["Layout","require","decorators","config","paths","renderRedux","module","exports","reactHook","BoringInjections","boring","router","createEndpointDecorator","reactEntry","entrypoint","shadowedEntrypoint","options","reactRoot","reactHandlerPaths","Object","assign","clientRoot","get","reactDecorator","entrypointDecorator","__dirname","app_dir","createDecorator","target","field","descriptor","before","ctx","res","reactPaths","Promise","resolve","react","name"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,UAAD,CAAtB;;AACA,MAAMC,UAAU,GAAGD,OAAO,CAAC,qBAAD,CAA1B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,eAAD,CAAtB;;AACA,MAAMG,KAAK,GAAGH,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMI,WAAW,GAAGJ,OAAO,CAAC,eAAD,CAA3B;;AAGAK,MAAM,CAACC,OAAP,GAAiB,SAASC,SAAT,CAAmBC,gBAAnB,EAAqC;AACpD,QAAM;AACJC,IAAAA;AADI,MAEFD,gBAFJ;AAIAP,EAAAA,UAAU,CAACS,MAAX,CAAkBC,uBAAlB,CAA0C,YAA1C,EAAwD,KAAxD;AACA,QAAMC,UAAU,GAAGX,UAAU,CAACS,MAAX,CAAkBE,UAArC;AACA,QAAMC,UAAU,GAAGZ,UAAU,CAACS,MAAX,CAAkBG,UAArC;;AAEAZ,EAAAA,UAAU,CAACS,MAAX,CAAkBE,UAAlB,GAA+B,SAASE,kBAAT,CAA4BC,OAA5B,EAAqC;AAElE,QAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC/BA,MAAAA,OAAO,GAAG;AAACC,QAAAA,SAAS,EAAED;AAAZ,OAAV;AACD;;AAED,UAAME,iBAAiB,GAAGC,MAAM,CAACC,MAAP,CAAc;AACtCC,MAAAA,UAAU,EAAElB,MAAM,CAACmB,GAAP,CAAW,yBAAX,EAAsC,eAAtC,CAD0B;AAEtCL,MAAAA,SAAS,EAAED,OAAO,CAACC,SAFmB;AAGtCH,MAAAA,UAAU,EAAEX,MAAM,CAACmB,GAAP,CAAW,yBAAX,EAAsC,gBAAtC;AAH0B,KAAd,EAIvBN,OAJuB,CAA1B;AAOA,UAAMO,cAAc,GAAGV,UAAU,CAACK,iBAAD,CAAjC;AACA,UAAMM,mBAAmB,GAAGV,UAAU,CAClCW,SAAS,GAAG,iBADsB,EAElCrB,KAAK,CAACsB,OAAN,GACER,iBAAiB,CAACG,UADpB,GAEE,GAFF,GAGEH,iBAAiB,CAACD,SAHpB,GAIEC,iBAAiB,CAACJ,UANc,CAAtC;AASA,WAAO,SAASa,eAAT,CAAyBC,MAAzB,EAAiCC,KAAjC,EAAwCC,UAAxC,EAAoD;AAEzD,aAAON,mBAAmB,CACtBI,MADsB,EAEtBC,KAFsB,EAGtBN,cAAc,CAACK,MAAD,EAASC,KAAT,EAAgBC,UAAhB,CAHQ,CAA1B;AAKD,KAPD;AAQD,GA/BD;;AAiCApB,EAAAA,MAAM,CAACqB,MAAP,CAAc,WAAd,EAA2B,UAASC,GAAT,EAAc;AACvC,QAAIA,GAAG,CAACV,GAAJ,CAAQT,UAAZ,EAAwB;AACtBmB,MAAAA,GAAG,CAACC,GAAJ,CAAQC,UAAR,GAAqBF,GAAG,CAACV,GAAJ,CAAQT,UAAR,CAAmB,CAAnB,CAArB;AACAmB,MAAAA,GAAG,CAACC,GAAJ,CAAQ5B,WAAR,GAAsBA,WAAtB;AACD;;AAED,WAAO8B,OAAO,CAACC,OAAR,EAAP;AACD,GAPD;AAUA1B,EAAAA,MAAM,CAAC2B,KAAP,GAAe;AACbrC,IAAAA;AADa,GAAf;AAIA,SAAO;AAACsC,IAAAA,IAAI,EAAE;AAAP,GAAP;AACD,CAzDD","sourcesContent":["const Layout = require('./Layout');\nconst decorators = require('../../../decorators');\nconst config = require('boring-config');\nconst paths = require('paths');\nconst renderRedux = require('./renderRedux');\n\n\nmodule.exports = function reactHook(BoringInjections) {\n  const {\n    boring,\n  } = BoringInjections;\n\n  decorators.router.createEndpointDecorator('reactEntry', 'get');\n  const reactEntry = decorators.router.reactEntry;\n  const entrypoint = decorators.router.entrypoint;\n\n  decorators.router.reactEntry = function shadowedEntrypoint(options) {\n\n    if (typeof options === 'string') {\n      options = {reactRoot: options};\n    }\n\n    const reactHandlerPaths = Object.assign({\n      clientRoot: config.get('boring.react.clientRoot', '/client/pages'),\n      reactRoot: options.reactRoot,\n      entrypoint: config.get('boring.react.entrypoint', '/entrypoint.js'),\n    }, options);\n\n\n    const reactDecorator = reactEntry(reactHandlerPaths);\n    const entrypointDecorator = entrypoint(\n        __dirname + '/clientEntry.js',\n        paths.app_dir\n        + reactHandlerPaths.clientRoot\n        + '/'\n        + reactHandlerPaths.reactRoot\n        + reactHandlerPaths.entrypoint\n    );\n\n    return function createDecorator(target, field, descriptor) {\n\n      return entrypointDecorator(\n          target,\n          field,\n          reactDecorator(target, field, descriptor)\n      );\n    };\n  };\n\n  boring.before('http::get', function(ctx) {\n    if (ctx.get.reactEntry) {\n      ctx.res.reactPaths = ctx.get.reactEntry[0];\n      ctx.res.renderRedux = renderRedux;\n    }\n\n    return Promise.resolve();\n  });\n\n\n  boring.react = {\n    Layout,\n  };\n\n  return {name: 'react'};\n};\n"],"file":"index.js"}