{"version":3,"sources":["../../../../../../src/lib/init-hooks/core-hooks/webpack-dev/test/staticInjections-test.js"],"names":["assert","require","proxyquire","noPreserveCache","logger","describe","staticInjections","beforeEach","asset_manifest","__dirname","assertions","res","deepEqual","locals","js_injections","css_injections","it","done","webpackStats","toJson","assetsByChunkName"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAMC,UAAU,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBE,eAAtB,EAAnB;;AACA,MAAMC,MAAM,GAAGH,OAAO,CAAC,eAAD,CAAtB;;AAEAI,QAAQ,CAAC,mBAAD,EAAsB,YAAW;AAEvC,MAAIC,gBAAJ;AAEAC,EAAAA,UAAU,CAAC,MAAM;AACfD,IAAAA,gBAAgB,GAAGJ,UAAU,CAAC,8BAAD,EAAiC;AAC5D,eAAS;AACPM,QAAAA,cAAc,EAAEC,SAAS,GAAE;AADpB;AADmD,KAAjC,CAA7B;AAKD,GANS,CAAV,CAJuC,CAavC;AACA;;AACA,WAASC,UAAT,CAAoBC,GAApB,EAAyB;AAEvBL,IAAAA,gBAAgB,CAACK,GAAD,EAAM,eAAN,CAAhB;AACAX,IAAAA,MAAM,CAACY,SAAP,CAAiBD,GAAG,CAACE,MAAJ,CAAWC,aAA5B,EAA2C,CAAC,sDAAD,CAA3C;AACAd,IAAAA,MAAM,CAACY,SAAP,CAAiBD,GAAG,CAACE,MAAJ,CAAWE,cAA5B,EAA4C,CAAC,wDAAD,CAA5C;AAEAJ,IAAAA,GAAG,CAACE,MAAJ,GAAa,EAAb;AACAP,IAAAA,gBAAgB,CAACK,GAAD,EAAM,cAAN,CAAhB;AACAX,IAAAA,MAAM,CAACY,SAAP,CAAiBD,GAAG,CAACE,MAAJ,CAAWC,aAA5B,EAA2C,CAAC,qDAAD,CAA3C;AAED;;AAEDE,EAAAA,EAAE,CAAC,4DAAD,EAA+D,UAASC,IAAT,EAAe;AAE9E,UAAMN,GAAG,GAAG;AACVE,MAAAA,MAAM,EAAG;AADC,KAAZ;AAIAH,IAAAA,UAAU,CAACC,GAAD,CAAV;AAEAM,IAAAA,IAAI;AACL,GATC,CAAF;AAYAD,EAAAA,EAAE,CAAC,oCAAD,EAAuC,UAASC,IAAT,EAAe;AACtD,UAAMN,GAAG,GAAG;AACVE,MAAAA,MAAM,EAAG;AACPK,QAAAA,YAAY,EAAE;AACZC,UAAAA,MAAM,EAAE,YAAW;AACjB,mBAAO;AACL;AACAC,cAAAA,iBAAiB,EAAE;AACjB,gCAAgB,CAAC,eAAD,EAAkB,mBAAlB,CADC;AAEjB,iCAAiB,CAAC,gBAAD,EAAmB,oBAAnB,CAFA;AAGjB,gCAAgB,CAAC,cAAD,EAAiB,kBAAjB;AAHC;AAFd,aAAP;AAQD;AAVW;AADP;AADC,KAAZ;AAiBAV,IAAAA,UAAU,CAACC,GAAD,CAAV;AAEAM,IAAAA,IAAI;AACL,GArBC,CAAF;AAsBD,CA7DO,CAAR","sourcesContent":["const assert = require('assert');\r\nconst proxyquire = require('proxyquire').noPreserveCache()\r\nconst logger = require('boring-logger');\r\n\r\ndescribe('Static Injections', function() {\r\n\r\n  let staticInjections;\r\n\r\n  beforeEach(() => {\r\n    staticInjections = proxyquire('../staticInjectionMiddleware', {\r\n      'paths': {\r\n        asset_manifest: __dirname +'/test-asset-manifest.json'\r\n      }\r\n    });\r\n  });\r\n\r\n\r\n  // the \"output\" should be the same\r\n  // regardlesss of the input\r\n  function assertions(res) {\r\n    \r\n    staticInjections(res, '/beep/boop.js');\r\n    assert.deepEqual(res.locals.js_injections, ['\\n<script async=\"true\" src=\"/beep/boop.js\"></script>'])\r\n    assert.deepEqual(res.locals.css_injections, ['\\n<link rel=\"stylesheet\" href=\"/beep/boop.css\"></link>'])\r\n\r\n    res.locals = {};\r\n    staticInjections(res, 'meow/bark.js');\r\n    assert.deepEqual(res.locals.js_injections, ['\\n<script async=\"true\" src=\"meow/bark.js\"></script>'])\r\n\r\n  }\r\n\r\n  it('Will read a manifest file and return the proper entrypoint', function(done) {\r\n\r\n    const res = {\r\n      locals : {}\r\n    }\r\n\r\n    assertions(res);\r\n\r\n    done();\r\n  });\r\n\r\n  \r\n  it('Will read webpack object on locals', function(done) {\r\n    const res = {\r\n      locals : {\r\n        webpackStats: {\r\n          toJson: function() {\r\n            return {\r\n              // this object is put on locals by the webpack middleware\r\n              assetsByChunkName: {\r\n                \"beep-boop.js\": [\"/beep/boop.js\", '/beep/boop.js.map'],\r\n                \"beep-boop.css\": [\"/beep/boop.css\", '/beep/boop.css.map'],\r\n                \"meow-bark.js\": [\"meow/bark.js\", \"meow/bark.js.map\"]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    assertions(res);\r\n\r\n    done();\r\n  });\r\n});\r\n"],"file":"staticInjections-test.js"}