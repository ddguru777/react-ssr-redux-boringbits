{"version":3,"sources":["../../../../../../src/lib/init-hooks/core-hooks/webpack-dev/test/staticInjections-test.js"],"names":["assert","require","proxyquire","noPreserveCache","logger","describe","staticInjections","beforeEach","asset_manifest","__dirname","assertions","res","deepEqual","locals","js_injections","css_injections","it","done","webpackStats","toJson","assetsByChunkName"],"mappings":";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAMC,UAAU,GAAGD,OAAO,CAAC,YAAD,CAAP,CAAsBE,eAAtB,EAAnB;;AACA,MAAMC,MAAM,GAAGH,OAAO,CAAC,eAAD,CAAtB;;AAEAI,QAAQ,CAAC,mBAAD,EAAsB,YAAW;AAEvC,MAAIC,gBAAJ;AAEAC,EAAAA,UAAU,CAAC,MAAM;AACfD,IAAAA,gBAAgB,GAAGJ,UAAU,CAAC,8BAAD,EAAiC;AAC5D,eAAS;AACPM,QAAAA,cAAc,EAAEC,SAAS,GAAE;AADpB;AADmD,KAAjC,CAA7B;AAKD,GANS,CAAV,CAJuC,CAavC;AACA;;AACA,WAASC,UAAT,CAAoBC,GAApB,EAAyB;AAEvBL,IAAAA,gBAAgB,CAACK,GAAD,EAAM,eAAN,CAAhB;AACAX,IAAAA,MAAM,CAACY,SAAP,CAAiBD,GAAG,CAACE,MAAJ,CAAWC,aAA5B,EAA2C,CAAC,sDAAD,CAA3C;AACAd,IAAAA,MAAM,CAACY,SAAP,CAAiBD,GAAG,CAACE,MAAJ,CAAWE,cAA5B,EAA4C,CAAC,wDAAD,CAA5C;AAEAJ,IAAAA,GAAG,CAACE,MAAJ,GAAa,EAAb;AACAP,IAAAA,gBAAgB,CAACK,GAAD,EAAM,cAAN,CAAhB;AACAX,IAAAA,MAAM,CAACY,SAAP,CAAiBD,GAAG,CAACE,MAAJ,CAAWC,aAA5B,EAA2C,CAAC,sDAAD,CAA3C;AAED;;AAEDE,EAAAA,EAAE,CAAC,4DAAD,EAA+D,UAASC,IAAT,EAAe;AAE9E,UAAMN,GAAG,GAAG;AACVE,MAAAA,MAAM,EAAG;AADC,KAAZ;AAIAH,IAAAA,UAAU,CAACC,GAAD,CAAV;AAEAM,IAAAA,IAAI;AACL,GATC,CAAF;AAYAD,EAAAA,EAAE,CAAC,oCAAD,EAAuC,UAASC,IAAT,EAAe;AACtD,UAAMN,GAAG,GAAG;AACVE,MAAAA,MAAM,EAAG;AACPK,QAAAA,YAAY,EAAE;AACZC,UAAAA,MAAM,EAAE,YAAW;AACjB,mBAAO;AACL;AACAC,cAAAA,iBAAiB,EAAE;AACjB,gCAAgB,CAAC,eAAD,EAAkB,mBAAlB,CADC;AAEjB,iCAAiB,CAAC,gBAAD,EAAmB,oBAAnB,CAFA;AAGjB,gCAAgB,CAAC,cAAD,EAAiB,kBAAjB;AAHC;AAFd,aAAP;AAQD;AAVW;AADP;AADC,KAAZ;AAiBAV,IAAAA,UAAU,CAACC,GAAD,CAAV;AAEAM,IAAAA,IAAI;AACL,GArBC,CAAF;AAsBD,CA7DO,CAAR","sourcesContent":["const assert = require('assert');\nconst proxyquire = require('proxyquire').noPreserveCache()\nconst logger = require('boring-logger');\n\ndescribe('Static Injections', function() {\n\n  let staticInjections;\n\n  beforeEach(() => {\n    staticInjections = proxyquire('../staticInjectionMiddleware', {\n      'paths': {\n        asset_manifest: __dirname +'/test-asset-manifest.json'\n      }\n    });\n  });\n\n\n  // the \"output\" should be the same\n  // regardlesss of the input\n  function assertions(res) {\n    \n    staticInjections(res, '/beep/boop.js');\n    assert.deepEqual(res.locals.js_injections, ['\\n<script async=\"true\" src=\"/beep/boop.js\"></script>'])\n    assert.deepEqual(res.locals.css_injections, ['\\n<link rel=\"stylesheet\" href=\"/beep/boop.css\"></link>'])\n\n    res.locals = {};\n    staticInjections(res, 'meow/bark.js');\n    assert.deepEqual(res.locals.js_injections, ['\\n<script async=\"true\" src=\"/meow/bark.js\"></script>'])\n\n  }\n\n  it('Will read a manifest file and return the proper entrypoint', function(done) {\n\n    const res = {\n      locals : {}\n    }\n\n    assertions(res);\n\n    done();\n  });\n\n  \n  it('Will read webpack object on locals', function(done) {\n    const res = {\n      locals : {\n        webpackStats: {\n          toJson: function() {\n            return {\n              // this object is put on locals by the webpack middleware\n              assetsByChunkName: {\n                \"beep-boop.js\": [\"/beep/boop.js\", '/beep/boop.js.map'],\n                \"beep-boop.css\": [\"/beep/boop.css\", '/beep/boop.css.map'],\n                \"meow-bark.js\": [\"meow/bark.js\", \"meow/bark.js.map\"]\n              }\n            }\n          }\n        }\n      }\n    }\n\n    assertions(res);\n\n    done();\n  });\n});\n"],"file":"staticInjections-test.js"}